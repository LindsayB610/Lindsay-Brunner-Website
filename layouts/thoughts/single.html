{{ define "main" }}
<article class="section">
  <div class="container-narrow">
    <header style="text-align: center; margin-bottom: 3rem">
      <div
        class="post-meta"
        style="justify-content: center; margin-bottom: 1.5rem"
      >
        <time>{{ .Date.Format "January 2, 2006" }}</time>
        {{ if .Params.tags }}
        <span>•</span>
        <span>{{ delimit .Params.tags " | " }}</span>
        {{ end }} {{ if .Site.Params.show_reading_time }}
        <span>•</span>
        <span>{{ .ReadingTime }} min read</span>
        {{ end }}
      </div>

      <h1>{{ .Title }}</h1>

      {{ if .Params.description }}
      <p
        style="
          font-size: 1.25rem;
          color: var(--dark-text-secondary);
          margin-top: 1.5rem;
          font-style: italic;
        "
      >
        {{ .Params.description }}
      </p>
      {{ end }}
    </header>

    <div class="article-content">{{ .Content }}</div>

    {{/* Previous/Next Post Navigation - sorted newest first */}}
    {{ $allThoughts := where (where .Site.RegularPages "Type" "thoughts") "Draft" false }}
    {{ $sortedThoughts := $allThoughts.ByDate.Reverse }}
    {{ $currentIndex := 0 }}
    {{ range $index, $post := $sortedThoughts }}
      {{ if eq $post.Permalink $.Permalink }}
        {{ $currentIndex = $index }}
      {{ end }}
    {{ end }}
    {{ $olderPost := index $sortedThoughts (add $currentIndex 1) }}
    {{ $newerPost := index $sortedThoughts (sub $currentIndex 1) }}
    {{ if or $olderPost $newerPost }}
    <nav style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--dark-border); display: flex; justify-content: space-between; gap: 2rem; flex-wrap: wrap;">
      {{ if $newerPost }}
      <div style="flex: 1; min-width: 200px;">
        <div style="font-size: 0.875rem; color: var(--dark-text-secondary); margin-bottom: 0.5rem;">Newer Post</div>
        <a href="{{ $newerPost.RelPermalink }}" style="color: var(--electric-purple); text-decoration: none; font-weight: 500; display: block;">
          ← {{ $newerPost.Title }}
        </a>
      </div>
      {{ end }}
      {{ if $olderPost }}
      <div style="flex: 1; min-width: 200px; text-align: {{ if $newerPost }}right{{ else }}left{{ end }};">
        <div style="font-size: 0.875rem; color: var(--dark-text-secondary); margin-bottom: 0.5rem;">Older Post</div>
        <a href="{{ $olderPost.RelPermalink }}" style="color: var(--electric-purple); text-decoration: none; font-weight: 500; display: block;">
          {{ $olderPost.Title }} →
        </a>
      </div>
      {{ end }}
    </nav>
    {{ end }}

    {{ if .Params.tags }}
    <footer
      style="
        margin-top: 4rem;
        padding: 2rem;
        background: var(--dark-surface);
        border-radius: var(--radius-lg);
        border: 1px solid var(--dark-border);
        position: relative;
        overflow: hidden;
      "
    >
      <div
        style="
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 2px;
          background: var(--gradient-rainbow);
          animation: tag-flow 4s linear infinite;
        "
      ></div>
      <h4 style="margin-bottom: 1rem; color: var(--electric-purple)">
        Topics:
      </h4>
      <div style="display: flex; flex-wrap: wrap; gap: 0.75rem">
        {{ range .Params.tags }}
        <span
          style="
            background: rgba(196, 255, 0, 0.1);
            color: var(--neon-green);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-family: var(--font-mono);
            border: 1px solid rgba(196, 255, 0, 0.2);
          "
          >{{ . }}</span
        >
        {{ end }}
      </div>
    </footer>
    {{ end }}
  </div>
</article>

<section class="section no-print">
  <div class="container-narrow">
    <h2 style="margin-bottom: 2rem; text-align: left">Related Posts</h2>
    <ul style="list-style: disc; padding-left: 1.5rem; display: flex; flex-direction: column; gap: 1rem">
      {{ if .Params.related_posts }}
        {{ range .Params.related_posts }}
        <li>
          <a href="{{ .url }}" style="color: var(--electric-purple); text-decoration: none; font-weight: 500;">
            {{ .title }}
          </a>
        </li>
        {{ end }}
      {{ else }}
        {{ $allThoughts := where (where .Site.RegularPages "Type" "thoughts") "Draft" false }}
        {{ $otherThoughts := where $allThoughts "Permalink" "!=" .Permalink }}
        {{ $recentThoughts := $otherThoughts.ByDate.Reverse | first 5 }}
        {{ range $recentThoughts }}
        <li>
          <a href="{{ .RelPermalink }}" style="color: var(--electric-purple); text-decoration: none; font-weight: 500;">
            {{ .Title }}
          </a>
        </li>
        {{ end }}
      {{ end }}
    </ul>
  </div>
</section>

<section class="section bg-surface no-print">
  <div class="container-narrow text-center">
    <h3>Found this useful?</h3>
    <p>
      Follow me for more insights on developer advocacy, technical leadership,
      and building experiences that developers actually want to engage with.
    </p>
    <div
      style="
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin-top: 2rem;
        flex-wrap: wrap;
      "
    >
      <a
        href="{{ .Site.Params.linkedin }}"
        class="hero-cta"
        target="_blank"
        rel="noopener"
        >Follow me</a
      >
    </div>
  </div>
</section>

<!-- Article JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": {{ .Title | jsonify }},
  "url": {{ .Permalink | jsonify }},
  "datePublished": {{ (.Date.UTC.Format "2006-01-02T15:04:05Z") | jsonify }},
  {{- if not .Lastmod.IsZero }}
  "dateModified": {{ (.Lastmod.UTC.Format "2006-01-02T15:04:05Z") | jsonify }},
  {{- else }}
  "dateModified": {{ (.Date.UTC.Format "2006-01-02T15:04:05Z") | jsonify }},
  {{- end }}
  "description": {{ .Params.description | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ .Site.Params.author | jsonify }},
    "url": {{ .Site.Params.linkedin | jsonify }}
  },
  "publisher": {
    "@type": "Person",
    "name": {{ .Site.Params.author | jsonify }},
    "url": {{ .Site.BaseURL | jsonify }}
  },
  {{- if .Params.social_image }}
  "image": {{ (.Params.social_image | absURL) | jsonify }},
  {{- else if .Site.Params.default_social_image }}
  "image": {{ (.Site.Params.default_social_image | absURL) | jsonify }},
  {{- end }}
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ .Permalink | jsonify }}
  }{{ if .Params.tags }},
  "keywords": {{ .Params.tags | jsonify }}{{ end }}{{ if .Site.Params.show_reading_time }},
  "timeRequired": {{ printf "PT%dM" .ReadingTime | jsonify }}{{ end }}
}
</script>

<!-- Breadcrumbs JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": {{ .Site.BaseURL | jsonify }}
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Thoughts",
      "item": {{ (printf "%s/thoughts/" .Site.BaseURL) | jsonify }}
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": {{ .Title | jsonify }},
      "item": {{ .Permalink | jsonify }}
    }
  ]
}
</script>
{{ end }}

